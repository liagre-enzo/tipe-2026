\documentclass[10pt]{report}
\usepackage{microtype}
\usepackage{amsmath}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage[a4paper,
            bindingoffset=0.2in,
            left=1in,
            right=1in,
            top=1in,
            bottom=1in,
            footskip=.25in]{geometry}
\title{Probabilités et recherche d'une heuristique dans Balatro.}
\author{LIAGRE Enzo}
\date{\today}

\begin{document}
    \maketitle

    \chapter*{Extrait}
    Ce document porte sur la recherche d'une heuristique dans le jeu Balatro.
    Le jeu est en quelques sortes un poker. Il y faut avec une taille de main 
    et de deck varibale, y marquer un certain nombre de points pour arriver à 
    la prochaine étape.
    \\ Le but est de pouvoir calculer l'espérence d'une variable aléatoire 
    définie avec le nombre de points obtensible en fonction d'une certaine main.
    Pour cela il suffit de définir l'état initial du jeu, où je jeu fonctionne 
    similairement à un five in hand au poker.
    La probabilité et combinatoire à chaque instant 
    $n \in [\![2, \space 24]\!]$ ne dépend que de l'instant $n-1$.
    \\ En finalité cette recherche sera transformé en code informatique 
    permettant l'implémentation d'une heuristique A* sur le jeu.

    \tableofcontents

    \chapter{Introduction}
    Cette étude porte sur le jeu Balatro, un jeu sorti courrent 2024, par Playstack.
    Celle-ci vient accompagner une étude informatique pour être présenter 
    aux oraux, des concours aux grandes écoles, de 2026.
    Ce TIPE a pour projet d'implémeter une heuristique pour permettre la 
    complétion automatique du jeu. 
    
    Balatro est un « roguelike » sur le thème du poker. Le genre roguelike 
    signifie qu'à chque fois que le joueur perd, il reprend de zéro.
    Le jeu s'organise en huit « mises » elles même divisées en trois manche 
    appelées « blindes ».
    Le but du jeu est de marquer un certain nombre de points prédéfini par manche.
    À la fin de chaque mises (à la troisième blinde donc) le joueur affronte 
    une « tête » qui désactive le compteur de points pour certaines cartes.
    Balatro possède plusieurs difficultés, dans ce document je ne 
    m'intéresserai qu'à la difficulté de base, une généralisation de 
    'étude aux autres difficultés pourrait faire l'objet d'un nouvel écrit.

    Ce document est donc une étude probabilistique du jeu. 
    Dans tous ce document on supposera que l'aléatoire est parfaitement 
    implémenter en informatique.

    \chapter{Étude d'un jeu de 52 cartes}
    
    \section{Combinatoire}

    Au poker plus la main est forte, moins elle a de chances d'apparaître.
    On se place ici dans un jeu de 52 cartes où l'on étudira le nombre de 
    combinaisons possibles par main de Balatro.

    Par ordre décroissant des scores, les mains possibles sont:
    \begin{description}
        \item[$\cdot$] la quinte flush (suite de cates de la même couleur)
        \item[$\cdot$] le carré (quatres cartes de la même valeur)
        \item[$\cdot$] le full (une pair et un brelan)
        \item[$\cdot$] la flush (cinq cartes de la même couleur)
        \item[$\cdot$] la quinte (suite de cartes)
        \item[$\cdot$] le brelan (trois cartes de même valeur)
        \item[$\cdot$] deux paires 
        \item[$\cdot$] la paire (deux cartes de même valeur)
        \item[$\cdot$] la carte haute
    \end{description}
    Balatro ajoute aussi trois mains normalement impossible au poker: 
    \begin{description}
        \item[$\cdot$] le flush five (cinq cartes identiques de même 
    couleur)
        \item[$\cdot$] le flush house (un full house où les cartes 
    sont de la même couleur)
        \item[$\cdot$] cinq cartes identiques (de même valeur)
    \end{description}
    Voici le nombre de mains de huit cartes possibles pour chaque combinaisons:

    \begin{description}
        \item \textbf{Nombre de combinaisons totales:}
        
        L'ordre ne comptant pas:

        \begin{align*}
            N_{\text{mains}} &= \binom{52}{8}
        \end{align*}

        \item \textbf{Les mains ajoutés:}
    
        Les trois mains ajoutés par le jeu demande des combinaisons de cartes 
        impossible dans un deck de 52 cartes.
        On a donc $0$ possibilités.

        \item \textbf{La quinte flush:}

        En piochant plus de $5$ carte, il est possible d'avoir plusieurs 
        suites dans notre main.
        Il est donc indispensable de prendre ce problème en compte pour 
        éviter de compter plusieurs fois les même pioches. \\ 
        On va alors choisir la haute carte définissant la suite, si elle \\
        Une main possédant une quinte flush est déterminée par la valeur de 
        la haute carte dans la suite.
        Soit $k \in [\![5, \space 14]\!]$ (on prend $14$ la 
        valeur de l'as, etc).

        \begin{itemize}
            \item Si $k = 14$: \\
            Une telle main est entièrement déterminée par: 
            \begin{enumerate}
                \item la couleur, \(\binom{4}{1}\) possibilités. 
                \item les trois cartes restantes, \(\binom{47}{3}\) 
                possibilités.
            \end{enumerate}
            Par principe multiplicatif; $\binom{4}{1} \times \binom{47}{3}$ 
            possibilités.

            \item Si $k = 13$: \\
            Une telle main est entièrement déterminée par:
            \begin{enumerate}
                \item la couleur, \(\binom{4}{1}\) possibilités.
                \item les trois cartes restantes, \(\binom{46}{3}\) 
                possibilités. En effet on ne peut pas prendre l'as 
                sinon on compte certaines combinaisons plusieurs fois.
            \end{enumerate}
            Par principe multiplicatif; $\binom{4}{1} \times \binom{46}{3}$ 
            possibilités.

            \item Si $k \in [\![5, \space 12]\!]$: \\
            Une telle main est entièrement déterminée par:
            \begin{enumerate}
                \item la couleur, \(\binom{4}{1}\) possibilités.
                \item les trois cartes restantes, \(\binom{47 - (13 -k)}{3}\) 
                possibilités.
            \end{enumerate}
            Par principe multiplicatif; 
            $\binom{4}{1} \times \binom{47 - (13-k)}{3}$ possibilités.

        \end{itemize}
        
        On peut donc appliquer un principe additif.
        \begin{align*}
            N_\text{quinte\_flush} &= \binom{4}{1} \times \binom{47}{3} 
            + \binom{4}{1} \times \binom{46}{3} 
            + \sum_{j=1}^{8}\binom{4}{1} \times \binom{47 - k}{3}  \\
            &= 4 \times \left[\binom{47}{3} + 2 \times \binom{46}{3} 
            + \sum_{j=2}^{8}\binom{47 - k}{3} \right]
        \end{align*}

        \item \textbf{le carré:}
        
        On se retrouve avec un problème similaire que celui de la Quinte Flush.
        En piochant 8 cates il est possible d'obtenir 2 carrés dans la même main.
        Une main, contenant un carré, est entièrement déterminée par:

        \begin{itemize}
            \item la valeur du carré: $\binom{13}{1}$ possibilités
            \item trois des quatres cartes restantes à piocher: 
            $\binom{48}{4}$ choix possibles
        \end{itemize}
        D'après le principe multiplicatif.
        \begin{align*}
            N_\text{carré} &\approx \binom{13}{1} \times \binom{48}{4}
        \end{align*}

        NB:\@ cette méthode compte toujours certaines mains plusieurs fois. 
        Il reste juste à enlever celles qui on été comptés plusieurs fois.

    \end{description}

    \newpage

    \section{Probabilité}   

    \chapter{Applications mathématiques à Balatro}
    \section{Définition d'une variable aléatoire}

    \newpage

    \section{Calculs sur l'instant initial du jeu}

    \chapter{Définition formelle d'une heuristique}
    \section{Probabilités à chaque instant}

    \newpage

    \section{Définition}
    
    \chapter{Conclusion}

    \appendix
    \chapter{Codes}

    \newpage

    \chapter{Ressouces}

\end{document}